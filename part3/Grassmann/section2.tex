\documentclass{ltjsreport}
\input{../../setting.tex}

\begin{document}
\section{Grassmann多様体とSchubert多様体}
\subsection{Grassmann多様体}

前節の準備をもとに数え上げ問題を定式化しよう。以下では係数体はすべて$\complex$で考えているとする。

\begin{defin}
  $\complex^{n}$の$d$次元部分空間全体のなす集合を$\mathcal{G}(d,n)$と書き、これをGrassmann多様体という。
\end{defin}

$d=1$のときGrassmann多様体は射影空間に他ならない。この意味でGrassmann多様体は射影空間の一般化である。
第3章冒頭で述べた数え上げ問題においては$\mathcal{G}(2,4)$を考えることになる。


Grassmann多様体が代数多様体の構造をもつことを示しておく。


まず、$\mathcal{M}(d,n)$をランク$d$の$n\times d$行列全体のなす集合とする。$\mathcal{M}(d,n)$は$\gl_d(\complex)$が右からの積で作用するが、この商$\mathcal{M}(d,n)/\gl_d(\complex)$は$\mathcal{G}(d,n)$と同一視される。実際、$\complex^n$の$d$次元部分空間に対して、その基底を並べた行列を考えればそれは$\gl_d(\complex)$軌道の違いを除いて一意的である。逆に$A\in\mathcal{M}(d,n)$に対して、$[A]$を$A$の列ベクトル(それは1次独立)が生成する部分空間とすれば$[A]\in\mathcal{G}(d,n)$である。
また、$\mathcal{M}(d,n)$は$\affine^{nd}$のZariski開集合であった(例\ref{M_d,n})が、$\mathcal{G}(d,n)$には$\mathcal{M}(d,n)$から誘導される商位相を入れておく。


次に$\complex^n$の$d$階交代テンソル空間$\bigwedge^d\complex^n$を考える。$\bigwedge^d\complex^n$は$\comb{n}{d}$次元ベクトル空間であるから、その射影化$\proj(\bigwedge^d\complex^n)$は$\proj^{\comb{n}{d}-1}$と同一視することができる。また、$e_1,\cdots,e_n$を$\complex^n$の標準基底とすれば$\omega\in\bigwedge^d\complex^n$は
\[
\omega=\sum_{1\leq i_1<\cdots <i_d\leq n}x_{i_1,\cdots, i_d}e_{i_1}\wedge\cdots\wedge e_{i_d}  
\]
と表せるので、$p(\omega)$の斉次座標は
\[
p(\omega)=[x_{i_1,\cdots,i_d}]_{1\leq i_1<\cdots<i_d\leq n}  
\]
のように書くことができる。ただし$p$は射影化$p:\bigwedge^d\complex^n\rightarrow \proj(\bigwedge^d\complex^n)$である。

$A\in\mathcal{M}(d,n)$に対して、$A$の列ベクトルを$v_1,\cdots,v_d\in\complex^n$とし写像$\tilde{\pi}:\mathcal{M}(d,n)\rightarrow \proj(\bigwedge^d\complex^n)$を
\[
\tilde{\pi}(A)=p(v_1\wedge\cdots\wedge v_d)=[\det(A_{i_1,\cdots,i_d})]_{1\leq i_1<\cdots<i_d\leq n}  
\]
とする。$\tilde{\pi}$は多項式写像なので連続である。また、$P=(a_{ij})\in\gl_d(\complex)$に対して、
\begin{align*}
  \tilde{\pi}(AP)
  &=p\left(
    (a_{11}v_1+\cdots+a_{d1}v_d)\wedge\cdots\wedge
    (a_{d1}v_1+\cdots+a_{dd}v_d)
  \right)\\
  &=p(\det P(v_1\wedge\cdots\wedge v_d))\\
  &=p(v_1\wedge\cdots\wedge v_d)\\
  &=\tilde{\pi}(A)
\end{align*}
となるから、$\tilde{\pi}$は連続写像$\pi:\mathcal{G}(d,n)\rightarrow \proj(\bigwedge^d\complex^n)$を誘導する。


\begin{prop}[Plucker埋め込み]\label{plucker}
  $\pi:\mathcal{G}(d,n)\rightarrow \proj(\bigwedge^d\complex^n)=\proj^{\comb{n}{d}-1}$は単射である。
\end{prop}

\begin{proof}
  次の補題を用いる。
  \begin{lemm}\label{ker_wedge}
    $V\in\mathcal{G}(d,n)$に対してその基底$v_1,\cdots,v_d$を固定して、$\omega=v_1\wedge\cdots\wedge v_d\in\bigwedge^d\complex^n$とする。$\Gamma_\omega:\complex^n\rightarrow \bigwedge^{d+1}\complex^n$を
    \[
    \Gamma_\omega(u)=\omega\wedge u  
    \]
    によって定めると、
    \begin{equation*}
      \ker\Gamma_\omega =V
    \end{equation*}
    が成り立つ。
  \end{lemm}
  
  \begin{proof}
    $V$の元が$\ker\Gamma_\omega$に含まれることは明らか。$u\in\ker\Gamma_\omega$であるとする。$v_1,\cdots,v_d$を延長して$\complex^n$の基底$v_1,\cdots,v_d,v_{d+1},\cdots,v_n$をとる。
    \[
    u=a_{1}v_1+\cdots+a_{d}v_d+a_{d+1}v_{d+1}+\cdots+a_nv_n  
    \]
    とおく。
    \begin{align*}
    0=\omega\wedge u
    &=v_1\wedge\cdots\wedge v_d\wedge(a_{1}v_1+\cdots+a_{d}v_d+a_{d+1}v_{d+1}+\cdots+a_nv_n )  \\
    &=a_{d+1}(v_1\wedge\cdots\wedge v_d\wedge v_{d+1})
        +\cdots+
      a_{n}(v_1\wedge\cdots\wedge v_d\wedge v_{n})
    \end{align*}
    となるが、$\{v_{i_1}\wedge\cdots\wedge v_{i_{d+1}}\}_{i_1<\cdots<i_{d+1}}$は1次独立であるので、$a_{d+1}=\cdots=a_n=0$. よって$u\in V$
  \end{proof}

  命題の証明に戻る。$\pi(V)=\pi(U)$であるとする。$U$の基底を$u_1,\cdots,u_d$とすると仮定より
  \[
  cu_1\wedge\cdots\wedge u_d=v_1\wedge\cdots\wedge v_d=\omega  
  \]
  となる定数$c$が存在する。したがって$\Gamma_\omega(u_i)=\omega\wedge u_i=0$であるから補題により、$U=\ker\Gamma_\omega= V$
\end{proof}
  
$\pi(\mathcal{G}(d,n))\subset\proj(\bigwedge^d\complex^n)$が代数的集合であることを示す。

\begin{defin}
  $\omega\in\bigwedge^d \complex^n$がtotally decomposableであるとは、1次独立な$v_1,\cdots,v_d\in V$が存在して$\omega=v_1\wedge\cdots\wedge v_d$となることをいう。
\end{defin}

\begin{lemm}\label{totally_decomposable}
  $\omega\in\bigwedge^d \complex^n$がtotally decomposableであることと$\Gamma_\omega:\complex^n\rightarrow\bigwedge^{d+1}\complex^n$のランクが$n-d$となることは同値である。
\end{lemm}

\begin{proof}
  $\omega=v_1\wedge\cdots\wedge v_d$とおく。このとき補題\ref{ker_wedge}の証明より$\dim\ker\Gamma_\omega=\dim \generated{v_1,\cdots,v_d}=d$であるから$\rank\Gamma_\omega=n-d$である。逆に$\rank\Gamma_\omega=n-d$であるとする。$\dim\ker\Gamma_\omega=d$であるから$\ker\Gamma_\omega$の基底$v_1,\cdots,v_d$をとり、これを延長して$\complex^n$の基底$v_1,\cdots,v_d,v_{d+1},\cdots,v_n$をとって
  \[
  \omega=\sum_{1\leq i_1<\cdots<i_d\leq n}c_{i_1,\cdots,i_d}v_{i_1}\wedge\cdots\wedge v_{i_d}  
  \]
  とおく。すると$\Gamma_\omega(v_j)=0$, $j=1,\cdots,d$より
  \begin{align*}
    &v_1\wedge\omega=0\text{ すなわち } c_{i_1,\cdots,i_d}=0\text{ for } i_1 > 1\\
    &v_2\wedge\omega=0\text{ すなわち } c_{i_1,\cdots,i_d}=0\text{ for }i_2 > 2\\
    &\qquad\vdots\\
    &v_d\wedge\omega=0\text{ すなわち } c_{i_1,\cdots,i_d}=0\text{ for }i_d > d
  \end{align*}
  よって$\omega=c_{1,2,\cdots,d}v_1\wedge\cdots\wedge v_d$
\end{proof}


$T\subset\bigwedge^d\complex^n$をtotally decomposableな元の集合とする。
$\pi(\mathcal{G}(d,n))=\proj(T)$である。$e_1,\cdots,e_n\in \complex^n$を標準基底とし、$\omega\in\bigwedge^d\complex^n$を
\[
\omega=\sum_{1\leq i_1<\cdots<i_d\leq n}x_{i_1,\cdots,i_d}e_{i_1}\wedge\cdots\wedge e_{i_d}  
\]
とおく。補題より、$p(\omega)\in\pi(\mathcal{G}(d,n))$であるための必要十分条件は$\rank\Gamma_\omega=n-d$となることである。この条件は$\Gamma_\omega:\complex^n\rightarrow \bigwedge^d\complex^n$を行列表示したとき、その$(n-d+1)\times(n-d+1)$小行列式がすべて$0$になることと同値である
\footnote{
  $\Gamma_\omega$のランクは必ず$n-d$以上であることに注意。実際、もし$\dim\ker\Gamma_{\omega}\geq d+1$であるなら、補題\ref{totally_decomposable}の証明と同様の議論をすると、$\omega=0$となってしまう。
}。
そして$\Gamma_\omega$の小行列式は$x_{i_1,\cdots,i_d}$の多項式で表されるから、$\pi(\mathcal{G}(d,n))$は$\proj({\bigwedge^d\complex^n})$の代数的集合である。

Grassmann多様体が既約であることを示そう。

\begin{lemm}\label{image_of_irrspace}
  $X$, $Y$を位相空間, $f:X\rightarrow Y$を連続写像とする。$A\subset X$が既約であるならば$f(A)$も既約である。
\end{lemm}

\begin{proof}
  $f(A)$が可約であったとして$f(A)=Z_1\cup Z_2$, $\varnothing\subsetneq Z_1,Z_2\subsetneq f(A)$となる閉集合$Z_1,Z_2$をとる。
  \[
  A\subset \inv{f}(f(A))=\inv{f}(Z_1\cup Z_2)=\inv{f}(Z_1)\cup\inv{f}(Z_2)  
  \]
  $f$は連続であるから$\inv{f}(Z_1), \inv{f}(Z_2)$は閉集合である。
  \[
  A=(A\cap\inv{f}(Z_1))\cup(A\cap\inv{f}(Z_2))
  \]
  より$A$は可約である。
\end{proof}

\begin{prop}
  $\mathcal{G}(d,n)$は既約である。
\end{prop}

\begin{proof}
  $V\in\mathcal{G}(d,n)$を固定して、$\alpha:\gl_n(\complex)\rightarrow\mathcal{G}(d,n)$を
  \[
  \alpha(P)=PV  
  \]
  によって定める。ただし$PV$は$V$の基底を$v_1,\cdots,v_d$とするとき$Pv_1,\cdots,Pv_d$によって生成される$d$次元部分空間を表す。$\alpha$は全射である。実際任意の$d$次元部分空間$W=\generated{w_1,\cdots,w_d}$に対して、各$v_i$を$w_i$に写すような$n$次正則行列$P$をとればよい。また$\alpha$は多項式写像であるから連続である。$\gl_n(\complex)$は既約であるから、補題\ref{image_of_irrspace}より$\mathcal{G}(d,n)$も既約である。
\end{proof}

なお、Plucker埋め込み$\pi$は実際に埋め込み、すなわち像への同相であることが知られている。

最後にGrassmann多様体の次元について考える。$1\leq i_1<\cdots <i_d\leq n$とする。
\[
\tilde{U}_{i_1,\cdots,i_d}=\set{A\in\mathcal{M}(d,n)}{\det A_{i_1,\cdots,i_d}\neq 0}  
\]
とする。ただし$A_{i_1,\cdots,i_d}$は$A$の第$i_1,\cdots,i_d$行をとりだした小正方行列であり、$E_d$は$d$次単位行列である。$\tilde{U}_{i_1,\cdots i_d}$はZariski開集合であり
\[
\mathcal{M}(d,n)=\bigcup_{i_1,\cdots,i_d}\tilde{U}_{i_1,\cdots,i_d}  
\]
である。$\phi:\mathcal{M}(d,n)\rightarrow \mathcal{M}(d,n)/\gl_d(\complex)=\mathcal{G}(d,n)$を自然な写像とすると、$\phi$は開写像である\footnote{
  一般に位相空間$X$に群$G$が作用しているとき、その軌道空間$X/G$への自然な写像$\phi:X\rightarrow X/G$は開写像である。実際、開集合$U\subset X$に対して
  \[
  \inv{\phi}(\phi(U))=\bigcup_{g\in G}gU
  \]
  であり$g$は$X$上の同相であるから右辺の各$gU$は開集合である。
}。したがって$U_{i_1,\cdots,i_d}=\phi(\tilde{U}_{i_1,\cdots,i_d})$は$\mathcal{G}(d,n)$の開集合であり$\mathcal{G}(d,n)=\bigcup_{i_1,\cdots,i_d}U_{i_1,\cdots,i_d}$である。$A\in\tilde{U}_{i_1,\cdots,i_d}$は適当に右から$\gl_d(\complex)$を書けることによって$A_{i_1,\cdots,i_d}=E_{d}$となるようにできるから
\[
U_{i_1,\cdots,i_d}=\set{[A]\in\mathcal{G}(d,n)}{A_{i_1,\cdots,i_d}=E_d}
\]
したがって$U_{i_1,\cdots,i_d}$は$\affine^{d(n-d)}$と同相であるから、事実\ref{dim_property}より
\[
\dim\mathcal{G}(d,n)=\dim U_{i_1,\cdots,i_d}=d(n-d)  
\]






\subsection{Shubert胞体とSchubert多様体}

第3章冒頭で述べた数え上げ問題においては$\proj^3$中の直線全体を考えたいから、$\mathcal{G}(2,4)$を考察していくことになる。重要な考え方として、ある条件をみたす直線の集合を$\mathcal{G}(2,4)$の部分多様体としてとらえることで、「複数の条件を満たす直線の数え上げ$\Leftrightarrow$いくつかの$\mathcal{G}(2,4)$の部分多様体の交点を数える」という問題の変換を行う。このように幾何学的な条件をみたす線形部分多様体をパラメトライズする空間をSchubert多様体という。




正則行列を右からかけることはいくつかの列基本変形を施すことと同値であるから、$[A]\in\mathcal{G}(d,n)$に対して、$A$の第$1$列から順に列基本変形を行えば、$[A]=[(a_{ij})]$はある$1\leq i_1<i_2<\cdots<i_d\leq n$があって
$A$の第$i_1,\cdots,i_d$行を取り出した小正方行列が単位行列であり、$(i_1,1),(i_2,2),\cdots,(i_d,d)$成分よりも右上の成分がすべて$0$になる。式で表すと
\begin{equation}\label{schubertcell}
a_{ij}=\left\{\begin{array}{cl}
  0 & \text{ if } i \leq i_{j}-1 \text{ or } i=i_k,\: j\leq k-1 \text{ for some $1\leq k\leq d$}\\
  1 & \text{ if } i = i_k,\: j = k \text{ for some $1\leq k\leq d$}
\end{array}\right.  
\end{equation}
をみたすということである。

\begin{eg}
  $[A]\in\mathcal{G}(2,4)$は次のいずれかの形になる。
  \begin{align*}
    &\bmat{
      1 & 0\\
      0 & 1\\
      * & *\\
      * & *
    },\qquad 
    \bmat{
      1 & 0\\
      * & 0\\
      0 & 1\\
      * & *
    },\qquad
    \bmat{
      1 & 0\\
      * & 0\\
      * & 0\\
      0 & 1
    }\\
    &\bmat{
      0 & 0\\
      1 & 0\\
      0 & 1\\
      * & *
    },\qquad
    \bmat{
      0 & 0\\
      1 & 0\\
      * & 0\\
      0 & 1
    },\qquad
    \bmat{
      0 & 0\\
      0 & 0\\
      1 & 0\\
      0 & 1
    }
  \end{align*}
  ただし$*$の部分には任意の複素数が入る。
\end{eg}

\begin{defin}
  $1\leq i_1<i_2<\cdots<i_d\leq n$に対して
  \[
  \Omega^\circ_{i_1,\cdots,i_d}=\set{[(a_{ij})]\in\mathcal{G}(d,n)}{a_{ij}\text{ satisfies (\ref{schubertcell})}}  
  \]
  をSchubert胞体という。
\end{defin}

上の議論から、
\[
\mathcal{G}(d,n)=\bigcup_{1\leq i_1<\cdots<i_d\leq n}\Omega^\circ_{i_1,\cdots,i_d}  
\]
が成り立つ。

\begin{eg}
$\mathcal{G}(2,4)$の場合
  \begin{align*}
    &\Omega^\circ_{1,2}=\bmat{
      1 & 0\\
      0 & 1\\
      * & *\\
      * & *
    },\qquad 
    \Omega^\circ_{1,3}=\bmat{
      1 & 0\\
      * & 0\\
      0 & 1\\
      * & *
    },\qquad
    \Omega^\circ_{1,4}=\bmat{
      1 & 0\\
      * & 0\\
      * & 0\\
      0 & 1
    }\\
    &\Omega^\circ_{2,3}=\bmat{
      0 & 0\\
      1 & 0\\
      0 & 1\\
      * & *
    },\qquad
    \Omega^\circ_{2,4}=\bmat{
      0 & 0\\
      1 & 0\\
      * & 0\\
      0 & 1
    },\qquad
    \Omega^\circ_{3,4}=\bmat{
      0 & 0\\
      0 & 0\\
      1 & 0\\
      0 & 1
    }
  \end{align*}
\end{eg}

$\Omega^\circ_{i_1,\cdots,i_d}$に含まれる$*$の数を$k$とすれば$\Omega^\circ_{i_1,\cdots,i_d}$は$\affine^k$に同相であるから$\dim\Omega^\circ_{i_1,\cdots,i_d}=k$である。

Schubert胞体とYoung図形の関係について述べておく。$1\leq i_1<\cdots<i_d\leq n$に対して、
\begin{equation}\label{young_and_schubert}
\lambda_{k}=i_{d+1-k}-d-1+k  
\end{equation}
とおくと、$(\lambda_1,\cdots,\lambda_d)$は$d\times (n-d)$の部分Young図形になる。逆に式(\ref{young_and_schubert})によって$d\times (n-d)$の部分Young図形からSchubert胞体を得ることができる。そこで$\mathcal{Y}_d(n)$を$d\times (n-d)$の部分Young図形全体のなす集合とし、$\lambda\in\mathcal{Y}_d(n)$に対応するSchubert胞体を$\Omega^\circ_{\lambda}$と表すことにする。

式(\ref{young_and_schubert})の対応関係をもう少し詳しく説明する。$d\times (n-d)$のYoung図形を用意し、各辺に沿って一番左下の頂点から一番右上の頂点に行く最短経路を考える。そのパターンは、各ステップごとに上に行くか右に行くかを選べば決まる。右上にたどり着くためには$d$回上に行く選択をしなければならないから、$i_1,\cdots,i_d$ステップ目で上に行き、それ以外では右に行くとすれば、1つ最短経路が定まる。この最短経路によって分けられる$d\times(n-d)$Young図形の左上の部分を、対応するYoung図形$\lambda$とするのである。
\begin{figure}[H]
  \centering
  \includegraphics*[scale=0.6]{C:/Users/Xsaku/OneDrive/Projects/graduate_project/src/young_and_schur.jpg}
\end{figure}
またこのとき対応する$\lambda$は、$A$から$i_1,\dots,i_d$行と$*$の入っている部分を取り除いてできる形(を$90^\circ$左に開店したもの)と同じである。



\begin{eg}
\begin{align*}
  \ytableausetup{boxsize=0.5em}
  &\Omega^\circ_{\varnothing}=\bmat{
    1 & 0\\
    0 & 1\\
    * & *\\
    * & *
  },\qquad 
  \Omega^\circ_{\ydiagram{1}}=\bmat{
    1 & 0\\
    * & \fbox{0}\\
    0 & 1\\
    * & *
  },\qquad
  \Omega^\circ_{\ydiagram{2}}=\bmat{
    1 & 0\\
    * & \fbox{0}\\
    * & \fbox{0}\\
    0 & 1
  }\\
  &\Omega^\circ_{\ydiagram{1,1}}=\bmat{
    \fbox{0} & \fbox{0}\\
    1 & 0\\
    0 & 1\\
    * & *
  },\qquad
  \Omega^\circ_{\ydiagram{2,1}}=\bmat{
    \fbox{0} & \fbox{0}\\
    1 & 0\\
    * & \fbox{0}\\
    0 & 1
  },\qquad
  \Omega^\circ_{\ydiagram{2,2}}=\bmat{
    \fbox{0} & \fbox{0}\\
    \fbox{0} & \fbox{0}\\
    1 & 0\\
    0 & 1
  }
  \ytableausetup{boxsize=normal}
\end{align*}
$\Box$で囲った成分のなす形とYoung図形とが対応している。
\end{eg}

\begin{prop}
  $I=(1\leq i_1<\cdots<i_d\leq n)$, $J=(1\leq j_1<\cdots<\leq n)$に対応するYoung図形をそれぞれ$\lambda,\mu$とする。このとき
  \[
  \lambda\subset\mu\Leftrightarrow i_k\leq j_k\text{ for all k}  
  \]
  である。
\end{prop}

\begin{proof}
  $\lambda\subset\mu$の定義は$\lambda_k\leq\mu_k$, for all $k$であるから、式(\ref{young_and_schubert})より直ちに従う。
\end{proof}



\begin{defin}[標準的な旗に付随するShubert多様体]
  $\lambda\in\mathcal{Y}_d(n)$に対して、
  \[
  \Omega_\lambda=\bigcup_{\mu\supset\lambda}\Omega^\circ_\mu
  \]
  をSchubert多様体という。
\end{defin}

ここで定義したSchubert多様体は、正確には標準的な旗に付随するSchubert多様体と呼ぶべきものである。旗の概念は後で定義するが、一般のSchubert多様体はこの標準的なSchubert多様体のもつ、次の幾何学的な性質を一般化する形で定める。

\begin{prop}\label{schubert_var}
  $\lambda\in\mathcal{Y}_d(n)$とする。$e_1,\cdots,e_n$を$\complex^n$の標準基底とし$F^k=\generated{e_{k+1},\cdots,e_n}$とおく。
  \[
  \Omega_{\lambda}=\set{V\in\mathcal{G}(d,n)}{\dim(V\cap F^{\lambda_k+d-k})\geq k}  
  \]
  が成り立つ。
\end{prop}

\begin{proof}
  $\mu\supset\lambda$とする。式(\ref{young_and_schubert})によって$\lambda,\mu$に対応する整数列をそれぞれ$(i_1,\cdots,i_d)$, $(j_1,\cdots,j_d)$とする。すなわち
  \[
  i_k=\lambda_{d+1-k}+k,\qquad j_k=\mu_{d+1-k}+k  
  \]
  である。$\mu\supset\lambda$より$j_k\geq i_k$である。
  
  $V\in\Omega_{\mu}^\circ$はベクトル
  \begin{align*}
    &v_1=e_{j_1}+f_1,\quad f_1\in\generated{e_{j_1+1},\cdots,e_n}=F^{j_1}\\
    &v_2=e_{j_2}+f_2,\quad f_2\in\generated{e_{j_2+1},\cdots,e_n}=F^{j_2}\\
    &\quad\vdots\\
    &v_d=e_{j_d}+f_d,\quad f_d\in\generated{e_{j_d+1},\cdots,e_n}=F^{j_d}
  \end{align*}
  を適当にとって$V=\generated{v_1,v_2,\cdots,v_d}$とできる。$\lambda_k+d-k=(i_{d+1-k}-d-1+k)+d-k=i_{d+1-k}-1$であるが、$\dim(V\cap F^{i_{d+1-k}-1})\geq k$を示そう。$v_{d+1-k},v_{d+2-k},\cdots,v_d\in F^{j_{d+1-k}-1}$である。$j_k\geq i_k$であるから$F^{j_{d+1-k}-1}\subset F^{i_{d+1-k}-1}$. したがって
  \[
  \dim(V\cap F^{i_{d+1-k}-1})\geq k
  \]
  である。

  逆に$V\in\mathcal{G}(d,n)$が$\dim(V\cap F^{i_{d+1-k}-1})\geq k$を満たしているとする。このとき$V$の基底$v_1,\cdots,v_d$として次の条件を満たすものがとれる。
  \begin{align*}
    &v_d\in V\cap F^{i_d-1}\\
    &v_{d-1}\in V\cap F^{i_{d-1}-1}\setminus F^{i_d-1}\\
    &\quad\vdots\\
    &v_1\in V\cap F^{i_1-1}\setminus F^{i_2-1}
  \end{align*}
  よって標準基底に関して成分表示すると
  \begin{align*}
    \begin{array}{ccr}
      v_d & = & c^{(d)}_{i_d}e_{i_d}+\cdots+c^{(1)}_{n}e_n\\
      v_{d-1} & = & c^{(d-1)}_{i_{d-1}}e_{i_{d-1}}+\cdots+c^{(d-1)}_{i_d-1}e_{i_d-1}+c^{(d-1)}_{i_d}e_{i_d}+\cdots+c^{(d-1)}_{n}e_n\\
          & \vdots & \\
      v_1 & = & c^{(1)}_{i_1}e_{i_1}+\cdots+c^{(1)}_{i_2-1}e_{i_2-1}+\cdots+c^{(1)}_{i_d}e_{i_d}+\cdots+c^{(1)}_{n}e_n
    \end{array}
  \end{align*}
  となるが、上の条件より
  \begin{align*}
    &c^{(d)}_{i_d},\dots,c^{(d)}_n\text{　は同時に$0$にならない}\\
    &c^{(d-1)}_{i_{d-1}},\cdots,c^{(d-1)}_{i_d-1}\text{　は同時に$0$にならない}\\
    &\quad\vdots\\
    &c^{(1)}_{i_1},\cdots,c^{(1)}_{i_2-1}\text{　は同時に$0$にならない}\\
  \end{align*}
  が成り立つ。各$k$において$0$でない$c^{(k)}_{i_{k}},\cdots,c^{(k)}_{n}$のうち最も左にあるものを$c^{(k)}_{j_k}$とおいて、$v_k$を$\frac{1}{c^{(k)}_{j_k}}v_k$で置き換えれば、
  \begin{align*}
    &v_d=e_{j_1}+f_1,\quad f_1\in\generated{e_{j_1+1},\cdots,e_n}=F^{j_1}\\
    &v_{d-1}=e_{j_2}+f_2,\quad f_2\in\generated{e_{j_2+1},\cdots,e_n}=F^{j_2}\\
    &\quad\vdots\\
    &v_d=e_{j_d}+f_d,\quad f_d\in\generated{e_{j_d+1},\cdots,e_n}=F^{j_d}
  \end{align*}
  の形にすることができる。これは$V=\generated{v_1,\cdots,v_d}$が$V\in\Omega_{j_1,\cdots,j_d}^\circ$であることに他ならないが、$j_k\geq i_k$であるので、$j_1,\cdots,j_d$の対応するYoung図形を$\mu$とすれば$\mu\supset\lambda$である。
\end{proof}



\begin{defin}
  $\complex^n$の部分空間の列
  \[
  \complex^n=F^0\supset F^1\supset \cdots\supset F^{n-1}\supset F^n=0,\qquad \dim F^k=n-k  
  \]
  を旗といい、$F^\bullet$と表す。とくに$e_1,\cdots,e_n$を標準基底として$F^k=\generated{e_{k+1},\cdots,e_n}$なる旗を標準旗といい$F_{st}^\bullet$と表す。$\proj^{n-1}$の線形部分多様体は$\complex^n$の部分空間と1対1に対応することを思い出せば、旗の各部分空間を射影化することで$\proj^{n-1}$の線形部分多様体の列を得る。このような$\proj^{n-1}$の部分集合の列も旗と呼ぶことにする。
\end{defin}

\begin{eg}
  $\complex^4$において旗
  \[
  \complex^4=F^0\supset F^1\supset F^2\supset F^3\supset F^4=0  
  \]
  の射影化は
  \[
  \proj^3\supset e_0\supset l_0\owns p_0\supset \varnothing  
  \]
  である。ここで$e_0$, $l_0$, $p_0$はそれぞれ$\proj^3$の平面, 直線, 点である。
\end{eg}

命題\ref{schubert_var}を一般化して次の定義を得る。

\begin{defin}
  $F^\bullet$を$\complex^n$の旗とする。$\lambda\in\mathcal{Y}_d(n)$に対して、
  \[
  \Omega_\lambda(F^\bullet)=\set{V\in\mathcal{G}(d,n)}{\dim(V\cap F^{\lambda_i+d-i})\geq i}
  \]
  を$F^\bullet$に付随するSchubert多様体という
\end{defin}


\begin{eg}\label{case_2,4}
$\mathcal{G}(2,4)$において、$F^\bullet$を任意の$\complex^4$の旗としてその射影化を$\proj^3\supset e_0\supset l_0\owns p_0\supset\varnothing$とする。このとき
\begin{align*}
  \ytableausetup{boxsize=0.5em}
  &\Omega_{\varnothing}=\mathcal{G}(2,4)\\
  &\Omega_{\ydiagram{1}}=\set{V\in\mathcal{G}(2,4)}{\dim(V\cap F^2)\geq 1}\approx\set{l\subset\proj^3:\text{直線}}{l\cap l_0\neq\varnothing}\\
  &\Omega_{\ydiagram{2}}=\set{V\in\mathcal{G}(2,4)}{\dim(V\cap F^3)\geq 1}\approx\set{l\subset\proj^3:\text{直線}}{l\owns p_0}\\
  &\Omega_{\ydiagram{1,1}}=\set{V\in\mathcal{G}(2,4)}{\dim(V\cap F^2)\geq 1,\:\dim(V\cap F^1)\geq 2}\approx\set{l\subset\proj^3:\text{直線}}{l\subset e_0}\\
  &\Omega_{\ydiagram{2,1}}=\set{V\in\mathcal{G}(2,4)}{\dim(V\cap F^3)\geq 1,\:\dim(V\cap F^1)\geq 2}\approx\set{l\subset\proj^3:\text{直線}}{ p_0\in l\subset e_0}\\
  &\Omega_{\ydiagram{2,2}}\approx\{l=l_0\}
  \ytableausetup{boxsize=normal}
\end{align*}
となり、Schubert多様体が幾何学的な線形部分多様体をパラメトライズしていることがわかる。

\end{eg}



\subsection{Schubert多様体の基本性質}
Schubert胞体・Schubert多様体の基本的な性質をいくつか示しておく。
まず、Schubert多様体がSchubert胞体の直和であることを示す。

\begin{prop}
  $\lambda\neq\mu$ならば、$\Omega_\lambda^\circ\cap\Omega_\mu^\circ=\varnothing$である。
\end{prop}

\begin{proof}
  $\lambda,\mu$に対応する整数列をそれぞれ$(i_1,\cdots,i_d)$, $(j_1,\cdots,j_d)$とおく。$V\in\Omega_\lambda^\circ$とすると、$V$の基底$v_1,\cdots,v_d$を
  \begin{align*}
    &v_1=e_{i_1}+f_1,\quad f_1\in\generated{e_{i_1+1},\cdots,e_n}=F^{i_1}\\
    &v_2=e_{i_2}+f_2,\quad f_2\in\generated{e_{i_2+1},\cdots,e_n}=F^{i_2}\\
    &\quad\vdots\\
    &v_d=e_{i_d}+f_d,\quad f_d\in\generated{e_{i_d+1},\cdots,e_n}=F^{i_d}
  \end{align*}
  となるように取れる。さらにもし$V\in\Omega_{\mu}^\circ$でもあるなら$V$の別の基底$w_1,\cdots,w_d$で
  \begin{align*}
    &w_1=e_{j_1}+s_1,\quad s_1\in\generated{e_{j_1+1},\cdots,e_n}=F^{j_1}\\
    &w_2=e_{j_2}+s_2,\quad s_2\in\generated{e_{j_2+1},\cdots,e_n}=F^{j_2}\\
    &\quad\vdots\\
    &w_d=e_{j_d}+s_d,\quad s_d\in\generated{e_{j_d+1},\cdots,e_n}=F^{j_d}
  \end{align*}
  となるものが存在する。ここで$j_k\neq\{i_1,\cdots,i_d\}$なる$j_k$に対して、$w_{k}\neq\generated{v_1,\cdots,v_d}$であることを示す。もし
  \[
  w_k=c_1v_1+\cdots+c_dv_d  
  \]
  となったとする。このとき
  \[
  e_{j_k}+s_k=c_1e_{i_1}+\cdots+c_de_{i_d}+c_1f_1+\cdots+c_df_d  
  \]
  だが、$i_1<\cdots<i_{t}<j_k<i_{t+1}<\cdots<i_d$として両辺$F^{j_k}$の剰余類を取れば
  \[
  \overline{e_{j_k}}=c_1\overline{e_{i_1}}+\cdots+c_t\overline{e_{i_t}}+c_1\overline{f_1}+\cdots+c_t\overline{f_t}  
  \]
  となる。$\overline{e_{i_1}}\in (F^{i_1-1}/F^{j_k})\setminus (F^{i_1}/F^{j_k})$かつ、それ以外のすべての元は$F^{i_1}/F^{j_k}$に含まれている。したがって$c_1=0$でなければならない。$e_{i_2}$に同様の議論をして$c_2=0$. 結局$c_t=0$までが言えるので、$\overline{e_{j_k}}=0$すなわち$e_{j_k}\in F^{j_k}$となるがこれは矛盾である。
\end{proof}

\begin{cor}
  次が成り立つ。
  \begin{enumerate}
    \item $\mathcal{G}(d,n)=\bigsqcup_{\lambda\in\mathcal{Y}_d(n)}\Omega_{\lambda}^\circ$
    \item $\Omega_{\lambda}(F^\bullet_{st})=\bigsqcup_{\mu\supset\lambda}\Omega_{\lambda}^\circ(F^\bullet_{st})$
  \end{enumerate}
\end{cor}





つぎに$\gl_n(\complex)$の作用について解説する。

$\gl_n(\complex)$は$\mathcal{G}(d,n)$に左からの積によって自然に作用する。$g:\mathcal{G}(d,n)\rightarrow\mathcal{G}(d,n)$は多項式写像であるので連続であり、$g^{-1}$がが逆写像を与えるので同相である。

旗$F^\bullet$と$g\in\gl_n(\complex)$に対して$gF^\bullet$を
\[
gF^\bullet:\complex^n=gF^0\supset gF^1\supset\cdots\supset gF^n=0
\]
によって定めれば$gF^\bullet$は新しい旗になる。逆に任意の旗$F^\bullet,E^\bullet$に対して、$F^k=\generated{v_{k+1},\cdots,v_n}$, $E^k=\generated{w_{k+1},\cdots,w_n}$となる$\complex^n$の基底$v_1,\cdots,v_n$, $w_1,\cdots,w_n$をとって変換行列$g$を考えれば、$gF^\bullet =E^\bullet$となる。言い換えれば$\gl_n(\complex)$は$\complex^n$の旗全体のなす集合に推移的に作用する。

$B\subset\gl_n(\complex)$を対角成分が$1$の下三角行列全体のなす部分群とし、$1\leq i_1<\cdots<i_d\leq n$に対して
\[
E_{i_1,\cdots,i_d}=\generated{e_{i_1},\cdots,e_{i_d}}\in\Omega_{i_1,\cdots,i_d}^\circ(F^\bullet_{st}) 
\]
とする。このとき
\[
Be_{i_k}=e_{i_k}+f_k,\quad f_k\in F^{i_k}  
\]
と書くことができるから、$\Omega_{i_1,\cdots,i_d}^\circ(F^\bullet_{st})=BE_{i_1,\cdots,i_d}$である。また$i_1,\cdots,i_d$に対応するYoung図形$\lambda$に対して
\[
E_\lambda=E_{i_1,\cdots,i_d}  
\]
とする。

\begin{prop}\label{flag_schubert}
  $F^\bullet$を旗、$g\in\gl_n(\complex)$とする。$g\Omega_\lambda(F^\bullet)=\Omega_{\lambda}(gF^\bullet)$である。  
\end{prop}

\begin{proof}
  \begin{align*}
    V\in\Omega_\lambda(gF^\bullet)
    &\Leftrightarrow \dim(V\cap gF^{\lambda_k+d-k})\geq k, \text{ for all $k$ }\\
    &\Leftrightarrow \dim(\inv{g}V\cap F^{\lambda_k+d-k})\geq k, \text{ for all $k$}\\
    &\Leftrightarrow \inv{g}V\in \Omega_{\lambda}(F^\bullet)\\
    &\Leftrightarrow V\in g\Omega_{\lambda}(F^\bullet)
  \end{align*}
\end{proof}

任意の旗$F^\bullet$に対して、$F^\bullet$はある$g\in\gl_n(\complex)$で$F^\bullet=gF_{st}^\bullet$と書けるが、
\[
\Omega_{\lambda}(F_{st}^\bullet)=\bigsqcup_{\mu\supset\lambda}\Omega_{\mu}^\circ  
\]
であったから、
\[
\Omega_{\lambda}(F)=\bigsqcup_{\mu\supset\lambda}g\Omega_{\mu}^\circ    
\]
そこで、$g\Omega_{\mu}^\circ$を旗$F^\bullet$に付随するSchubert胞体といい$\Omega_{\mu}^\circ(F^\bullet)$とかく。


このように一般のSchubert多様体は$\gl_n(\complex)$の作用によって得られる。

次にSchubert多様体が既約な代数多様体であることを示す。


\begin{prop}
  $\Omega_{\lambda}(F^\bullet)\subset \mathcal{G}(d,n)\subset\proj(\bigwedge^d\complex^n)$はZariski閉集合である。
\end{prop}

\begin{proof}
  命題\ref{flag_schubert}より$\Omega_{\lambda}(F^{\bullet}_{st})$に対して示せば十分である。
  また、命題\ref{zariski_vs_quotient}より、$\mathcal{M}(d,n)$によって誘導される位相に関して閉集合であることを示せばよい。$\Omega_{\lambda}(F^\bullet_{st})=\set{V\in\mathcal{G}(d,n)}{\dim V\cap F^{\lambda_i+d-i}\geq i}$において、線形写像$\eta_i(V)$を
  \[
  \eta_i(V):V\rightarrow \complex^n\rightarrow \complex^n/F^{\lambda_i+d-i}
  \]
  なる自然な写像とすれば、$\dim V\cap F^{\lambda_i+d-i}\geq i$は$\rank\eta_i(V)\geq d-i$と同値である。
  $\phi:\mathcal{M}(d,n)\rightarrow\mathcal{M}(d,n)/\gl_d(\complex)=\mathcal{G}(d,n)$を自然な写像とすれば
  \[
  \inv{\phi}(\Omega_{\lambda}(F^\bullet_{st}))=\set{A\in\mathcal{M}(d,n)}{\rank\eta_i([A])\geq d-i}  
  \]
  となる。したがって$\rank\eta_i([A])\geq d-i$が($A$の成分の多項式)$=0$の形で記述できることがわかればよい。$V=[A]$とする。$V$の基底を$A$の列ベクトル, $\complex^n$の基底を標準基底でとれば、
  \[
  V\rightarrow \complex^n
  \]
  の表現行列は$A$に他ならない。また、$\complex^n/F^{\lambda_i+d-i}$の基底として$e_1,\cdots,e_{\lambda_i+d-i}$がとれるから
  \[
  \complex^n\rightarrow \complex^n/F^{\lambda_i+d-i}  
  \]
  の表現行列は
  \[
  \pmat{E_{\lambda_i+d-i}&0},\qquad \text{ただし$E_{\lambda_i+d-i}$は$\lambda_i+d-i$次単位行列}  
  \]
  となる。したがって$\eta_i([A])$の表現行列は
  \[
  \pmat{E_{\lambda_i+d-i}&0}A=\pmat{A_{\lambda_i+d-i}&0}  
  \]
  となる。ただし$A_{\lambda_i+d-i}$は$A$の第$1$行から$\lambda_i+d-i$行までを取り出した小正方行列である。よって$\rank\eta_i(V)\geq d-i$は$\pmat{A_{\lambda_i+d-i}&0}$の$d-i+1$小行列式がすべて$0$になることと同値であるから、これは($A$の成分の多項式)$=0$の形である。
\end{proof}



\begin{prop}\label{schubert_closure}
  Schubert多様体$\Omega_{\lambda}(F^\bullet)$はSchubert胞体$\Omega_{\lambda}^\circ(F^\bullet)$の閉包である：
  \[
    \Omega_{\lambda}(F^\bullet)=\overline{\Omega_{\lambda}^\circ(F^\bullet)}
  \]
\end{prop}

\begin{proof}
  $\Omega_{\lambda}(F^{\bullet}_{st})$に対して示せば十分である。次の補題を用いる。
  \begin{lemm}
    $\lambda\subset\mu$ならば$\Omega_{\mu}^\circ(F^\bullet_{st})\subset\overline{\Omega_{\lambda}^\circ(F^\bullet_{st})}$
  \end{lemm}

  \begin{proof}
    $\lambda,\mu$に$I=(1\leq i_1<\cdots< i_d\leq n),J=(1\leq j_i<\cdots<j_d\leq n)$がそれぞれ対応しているとする。$i_k\leq j_k$ for all $k$である。次の操作を考える。
    \begin{equation}\label{operation}
    \text{$\alpha\notin I\setminus J$, $\beta\in J$なる$\alpha <\beta$をとり、$J$から$\beta$を取り除き$\alpha$を加える。}
    \end{equation}
    $J$に操作(\ref{operation})を有限回施すことで$I$を得ることができる。そこで、$J$が操作(\ref{operation})を1回施すことで$I$を得ることができる場合を考えればよい。実際、もしこの場合に証明できれば、$J$に$k$回操作(\ref{operation})を施したものを$J_k$とおけば、
    \[
    \Omega_{J}^\circ(F^\bullet_{st})
    \subset\overline{\Omega_{J_1}^\circ(F^\bullet_{st})}\subset\overline{\overline{\Omega_{J_2}^\circ(F^\bullet_{st})}}=\overline{\Omega_{J_2}^\circ(F^\bullet_{st})}  
    \subset\cdots
    \]
    となるから示せる。

    \[
    \text{例： }I=(1,3,6),\: J=(1,4,6)\qquad\rightarrow\qquad (\alpha=3,\beta=4)
    \]
    $E_J\in \overline{\Omega_{I}^\circ(F^\bullet_{st})}$を示せば
    $\Omega_{J}^\circ(F^\bullet_{st})
    =BE_J\subset B\overline{\Omega_{I}^\circ(F^\bullet_{st})}\subset \overline{\Omega_{I}^\circ(F^\bullet_{st})}$より主張が従う。$\phi:\proj^1\rightarrow \mathcal{G}(d,n)$を
    \[
    \phi([s:t])=\generated{\set{e_k}{k\in I\cap J}\cup\{se_{\alpha}+te_{\beta}\}}  
    \]
    によって定める。$\phi$は多項式写像であるので連続である。$\phi([1:0])=E_I$, $\phi([0:1])=E_J$であるから、$\phi$は$E_I$と$E_J$を結ぶ曲線だと思うことができる。しかも$\phi([1:t])\in \Omega_{I}^\circ(F^\bullet_{st})$である。よって
    \[
    E_J=\phi([0:1])\in\phi(\overline{\proj^1\setminus\{[0:1]\}})
    \subset\overline{\phi(\proj^1\setminus\{[0:1]\})}\subset\overline{\Omega_{I}^\circ(F^\bullet_{st})}
    \]
    となり示せた。
  \end{proof}

  命題\ref{schubert_closure}の証明に戻ろう。補題より
  \[
  \Omega_{\lambda}(F^\bullet_{st})
  =\bigsqcup_{\mu\supset\lambda}\Omega_{\mu}^\circ(F^\bullet_{st})  
  \subset
  \overline{\Omega_{\lambda}^\circ(F^\bullet_{st})}
  \]
  であり、$\Omega_{\lambda}^\circ(F^\bullet_{st})\subset\Omega_{\lambda}(F^\bullet_{st})$かつ$\Omega_{\lambda}(F^\bullet_{st})$は閉集合であるから、
  \[
    \overline{\Omega_{\lambda}^\circ(F^\bullet_{st})}\subset\Omega_{\lambda}(F^\bullet_{st})  
  \]
\end{proof}

\begin{cor}
  Schubert多様体は既約である。
\end{cor}

\begin{proof}
  一般に位相空間$X$の部分集合$A$が既約であるならその閉包$\overline{A}$も既約である。実際、$\overline{A}=Y_1\cup Y_2$となる閉集合$Y_1,Y_2$が存在したら、$A=(\overline{A}\cap Y_1)\cup(\overline{A}\cap Y_2)$となるから$A$は可約になる。

  Schubert胞体はアフィン空間と同相であるから既約であるので、その閉包であるSchubert多様体も既約である。
\end{proof}


一般に代数多様体$X$の部分多様体$Z$について、$\dim X-\dim Z$を$Z$の余次元といい$\codim Z$と書く。

\begin{fact}[\cite{enu_geo}]
  $\codim\Omega_{\lambda}(F^\bullet)=|\lambda|$である。
\end{fact}



\end{document} 